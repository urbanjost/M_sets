\hypertarget{namespacem__sets}{}\doxysection{m\+\_\+sets Module Reference}
\label{namespacem__sets}\index{m\_sets@{m\_sets}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_aadc83648d8e7c649dd25092e4c1b706a}{unique}} (A, set\+Order)
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_ac9d18afbd06acb57aa3f80d01e362192}{union}} (A, B, set\+Order)
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_a1f2ad921b60fb9f07de801e6143f9589}{intersect}} (A, B, set\+Order)
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_a0d16eebd8fe9d67f729334252f3f6642}{setdiff}} (A, B, set\+Order)
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_a55e68d01d44ad485ebe1d85c094e5ca4}{ismember}} (A, B)
\item 
integer function, dimension(\+:), allocatable, public \mbox{\hyperlink{namespacem__sets_a6b93bcd09c4e1305dc41087c42c3f1f9}{setxor}} (A, B, set\+Order)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__sets_a1f2ad921b60fb9f07de801e6143f9589}\label{namespacem__sets_a1f2ad921b60fb9f07de801e6143f9589}} 
\index{m\_sets@{m\_sets}!intersect@{intersect}}
\index{intersect@{intersect}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{intersect()}{intersect()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::intersect (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{integer, dimension(\+:), intent(in)}]{B,  }\item[{character(len=$\ast$), intent(in), optional}]{set\+Order }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{56 \textcolor{comment}{! C = intersect(A,B) returns the data common to both A and B, with no repetitions. C is in sorted order by default}}
\DoxyCodeLine{57 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: A(:)}
\DoxyCodeLine{58 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: B(:)}
\DoxyCodeLine{59 \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: setOrder}
\DoxyCodeLine{60 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: result(:)}
\DoxyCodeLine{61 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: iwrk(:)}
\DoxyCodeLine{62    result = [unique(a, setorder), unique(b, setorder)]}
\DoxyCodeLine{63    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk)) \textcolor{keyword}{deallocate} (iwrk)}
\DoxyCodeLine{64    \textcolor{keyword}{allocate} (iwrk(\textcolor{keyword}{size}(result)))}
\DoxyCodeLine{65    \textcolor{keyword}{call }occurrences\_(result, iwrk)}
\DoxyCodeLine{66    result = unique(pack(result, iwrk .gt. 1), setorder)}

\end{DoxyCode}


References unique().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{namespacem__sets_a1f2ad921b60fb9f07de801e6143f9589_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{namespacem__sets_a1f2ad921b60fb9f07de801e6143f9589_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__sets_a55e68d01d44ad485ebe1d85c094e5ca4}\label{namespacem__sets_a55e68d01d44ad485ebe1d85c094e5ca4}} 
\index{m\_sets@{m\_sets}!ismember@{ismember}}
\index{ismember@{ismember}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{ismember()}{ismember()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::ismember (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{integer, dimension(\+:), intent(in)}]{B }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{86 \textcolor{comment}{! C = ismember(A,B) returns an array containing 1 (true) where the data in A is found in B. Elsewhere, the array contains 0}}
\DoxyCodeLine{87 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}   :: a(:)}
\DoxyCodeLine{88 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}   :: b(:)}
\DoxyCodeLine{89 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}  :: result(:)}
\DoxyCodeLine{90 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}  :: iwrk1(:)}
\DoxyCodeLine{91 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}  :: iwrk2(:)}
\DoxyCodeLine{92 \textcolor{keywordtype}{integer}               :: inums}
\DoxyCodeLine{93    inums=\textcolor{keyword}{size}(a)}
\DoxyCodeLine{94    result = [ a, unique(b) ] \textcolor{comment}{! potentially a lot of memory}}
\DoxyCodeLine{95    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk2)) \textcolor{keyword}{deallocate} (iwrk2)}
\DoxyCodeLine{96    \textcolor{keyword}{allocate} (iwrk2(\textcolor{keyword}{size}(a)))}
\DoxyCodeLine{97    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk1)) \textcolor{keyword}{deallocate} (iwrk1)}
\DoxyCodeLine{98    \textcolor{keyword}{allocate} (iwrk1(\textcolor{keyword}{size}(result)))}
\DoxyCodeLine{99    \textcolor{keyword}{call }occurrences\_(result, iwrk1)}
\DoxyCodeLine{100    \textcolor{keyword}{call }occurrences\_(a, iwrk2)}
\DoxyCodeLine{101    result=iwrk1(:inums)-\/iwrk2}
\DoxyCodeLine{102    result=merge(0,1,result.eq.0)}
\DoxyCodeLine{103 }

\end{DoxyCode}


References unique().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{namespacem__sets_a55e68d01d44ad485ebe1d85c094e5ca4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{namespacem__sets_a55e68d01d44ad485ebe1d85c094e5ca4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__sets_a0d16eebd8fe9d67f729334252f3f6642}\label{namespacem__sets_a0d16eebd8fe9d67f729334252f3f6642}} 
\index{m\_sets@{m\_sets}!setdiff@{setdiff}}
\index{setdiff@{setdiff}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{setdiff()}{setdiff()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::setdiff (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{integer, dimension(\+:), intent(in)}]{B,  }\item[{character(len=$\ast$), intent(in), optional}]{set\+Order }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{70 \textcolor{comment}{! C = setdiff(A,B) returns the data in A that is not in B, with no repetitions. C is in sorted order by default.}}
\DoxyCodeLine{71 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: a(:)}
\DoxyCodeLine{72 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: b(:)}
\DoxyCodeLine{73 \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: setOrder}
\DoxyCodeLine{74 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: result(:)}
\DoxyCodeLine{75 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: iwrk(:)}
\DoxyCodeLine{76    result = unique(b, setorder=\textcolor{stringliteral}{'stable'})}
\DoxyCodeLine{77    result = [unique(a, setorder=\textcolor{stringliteral}{'stable'}), result, result] \textcolor{comment}{! potentially a lot of memory}}
\DoxyCodeLine{78    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk)) \textcolor{keyword}{deallocate} (iwrk)}
\DoxyCodeLine{79    \textcolor{keyword}{allocate} (iwrk(\textcolor{keyword}{size}(result)))}
\DoxyCodeLine{80    \textcolor{keyword}{call }occurrences\_(result, iwrk)}
\DoxyCodeLine{81    result = unique(pack(result, iwrk .eq. 1), setorder)}
\DoxyCodeLine{82 }

\end{DoxyCode}


References unique().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{namespacem__sets_a0d16eebd8fe9d67f729334252f3f6642_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{namespacem__sets_a0d16eebd8fe9d67f729334252f3f6642_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__sets_a6b93bcd09c4e1305dc41087c42c3f1f9}\label{namespacem__sets_a6b93bcd09c4e1305dc41087c42c3f1f9}} 
\index{m\_sets@{m\_sets}!setxor@{setxor}}
\index{setxor@{setxor}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{setxor()}{setxor()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::setxor (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{integer, dimension(\+:), intent(in)}]{B,  }\item[{character(len=$\ast$), intent(in), optional}]{set\+Order }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{107 \textcolor{comment}{! C = setxor(A,B,setOrder) returns the data of A and B that are not in their intersection}}
\DoxyCodeLine{108 \textcolor{comment}{!                          (the symmetric difference), with no repetitions. That is, setxor returns the}}
\DoxyCodeLine{109 \textcolor{comment}{!                          data that occurs in A or B, but not both. C is in sorted order.}}
\DoxyCodeLine{110 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: a(:)}
\DoxyCodeLine{111 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: b(:)}
\DoxyCodeLine{112 \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: setOrder}
\DoxyCodeLine{113 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: result(:)}
\DoxyCodeLine{114 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: iwrk1(:)}
\DoxyCodeLine{115 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: iwrk2(:)}
\DoxyCodeLine{116 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: iwrk3(:)}
\DoxyCodeLine{117 \textcolor{keywordtype}{integer}                                :: inums}
\DoxyCodeLine{118    inums=\textcolor{keyword}{size}(a)}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    result = [ a, b ] \textcolor{comment}{! potentially a lot of memory}}
\DoxyCodeLine{121    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk1)) \textcolor{keyword}{deallocate} (iwrk1)}
\DoxyCodeLine{122    \textcolor{keyword}{allocate} (iwrk1(\textcolor{keyword}{size}(result)))}
\DoxyCodeLine{123    \textcolor{keyword}{call }occurrences\_(result, iwrk1)}
\DoxyCodeLine{124 }
\DoxyCodeLine{125    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk2)) \textcolor{keyword}{deallocate} (iwrk2)}
\DoxyCodeLine{126    \textcolor{keyword}{allocate} (iwrk2(\textcolor{keyword}{size}(a)))}
\DoxyCodeLine{127    \textcolor{keyword}{call }occurrences\_(a, iwrk2)}
\DoxyCodeLine{128 }
\DoxyCodeLine{129    \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(iwrk3)) \textcolor{keyword}{deallocate} (iwrk3)}
\DoxyCodeLine{130    \textcolor{keyword}{allocate} (iwrk3(\textcolor{keyword}{size}(b)))}
\DoxyCodeLine{131    \textcolor{keyword}{call }occurrences\_(b, iwrk3)}
\DoxyCodeLine{132 }
\DoxyCodeLine{133    iwrk1=iwrk1-\/[iwrk2,iwrk3]}
\DoxyCodeLine{134 }
\DoxyCodeLine{135    result=pack(result,iwrk1.eq.0)}
\DoxyCodeLine{136    result=unique(result,setorder)}
\DoxyCodeLine{137 }

\end{DoxyCode}


References unique().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{namespacem__sets_a6b93bcd09c4e1305dc41087c42c3f1f9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=289pt]{namespacem__sets_a6b93bcd09c4e1305dc41087c42c3f1f9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__sets_ac9d18afbd06acb57aa3f80d01e362192}\label{namespacem__sets_ac9d18afbd06acb57aa3f80d01e362192}} 
\index{m\_sets@{m\_sets}!union@{union}}
\index{union@{union}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{union()}{union()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::union (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{integer, dimension(\+:), intent(in)}]{B,  }\item[{character(len=$\ast$), intent(in), optional}]{set\+Order }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{47 \textcolor{comment}{! C = union(A,B) returns the combined data from A and B with no repetitions. C is in sorted order.}}
\DoxyCodeLine{48 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: A(:)}
\DoxyCodeLine{49 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: B(:)}
\DoxyCodeLine{50 \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: setOrder}
\DoxyCodeLine{51 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: result(:)}
\DoxyCodeLine{52    result = unique([a, b], setorder)}

\end{DoxyCode}


References unique().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{namespacem__sets_ac9d18afbd06acb57aa3f80d01e362192_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{namespacem__sets_ac9d18afbd06acb57aa3f80d01e362192_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__sets_aadc83648d8e7c649dd25092e4c1b706a}\label{namespacem__sets_aadc83648d8e7c649dd25092e4c1b706a}} 
\index{m\_sets@{m\_sets}!unique@{unique}}
\index{unique@{unique}!m\_sets@{m\_sets}}
\doxysubsubsection{\texorpdfstring{unique()}{unique()}}
{\footnotesize\ttfamily integer function, dimension(\+:), allocatable, public m\+\_\+sets\+::unique (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{A,  }\item[{character(len=$\ast$), intent(in), optional}]{set\+Order }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{20 \textcolor{comment}{! C = unique(A) returns the same data as in A, but with no repetitions. C is in sorted order.}}
\DoxyCodeLine{21 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}                    :: A(:)}
\DoxyCodeLine{22 \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: setOrder}
\DoxyCodeLine{23 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}                   :: result(:)}
\DoxyCodeLine{24 \textcolor{keywordtype}{character(len=:)}, \textcolor{keywordtype}{allocatable}          :: setOrder\_}
\DoxyCodeLine{25 \textcolor{keywordtype}{integer}                                :: nuni}
\DoxyCodeLine{26    \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(setorder)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{27       setorder\_ = setorder}
\DoxyCodeLine{28    \textcolor{keywordflow}{else}}
\DoxyCodeLine{29       setorder\_ = \textcolor{stringliteral}{'sorted'}}
\DoxyCodeLine{30 \textcolor{keywordflow}{   end if}}
\DoxyCodeLine{31    result = a}
\DoxyCodeLine{32    \textcolor{keywordflow}{select case} (setorder\_)}
\DoxyCodeLine{33    \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'stable'})}
\DoxyCodeLine{34       \textcolor{keyword}{call }unique\_(result, nuni)}
\DoxyCodeLine{35       result = result(:nuni)}
\DoxyCodeLine{36    \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'sorted'})}
\DoxyCodeLine{37       \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(result)) \textcolor{keyword}{deallocate} (result)}
\DoxyCodeLine{38       \textcolor{keyword}{allocate} (result(\textcolor{keyword}{size}(a)))}
\DoxyCodeLine{39       \textcolor{keyword}{call }rank\_unique\_(a, result, nuni)}
\DoxyCodeLine{40       result = a(result(:nuni))}
\DoxyCodeLine{41 \textcolor{keywordflow}{   case default}}
\DoxyCodeLine{42       stop \textcolor{stringliteral}{'*unique* unknown setOrder '}//setorder\_}
\DoxyCodeLine{43 \textcolor{keywordflow}{   end select}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__sets_aadc83648d8e7c649dd25092e4c1b706a_icgraph}
\end{center}
\end{figure}
